<!doctype html>

<!-- begin code hien thi thong tin dang xu ly  added by nhaht 01/10/2017-->

<style>
    .fixed {
        position: absolute;
        width: 300px;
        height: 100px;
        border: 1px solid #73AD21;
        z-index: 3;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        margin: auto;
    }
    .form-transfer{
        margin-top: -10rem;
    }
</style>


<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="-1" />
    <meta http-equiv="pragma" content="no-cache" />
    <meta name="viewport" content="width=device-width">


    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="css/mainstyle.css">
    <link rel="stylesheet" type="text/css" href="css/reponsive.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">


    <!-- Tranhistory Paging -->
    <style type="text/css">
        .paging-nav {
            text-align: right;
            padding-top: 2px;
        }
        
        .paging-nav a {
            margin: auto 1px;
            text-decoration: none;
            display: inline-block;
            padding: 1px 7px;
            background: #91b9e6;
            color: white;
            border-radius: 3px;
        }
        
        .paging-nav .selected-page {
            background: #187ed5;
            font-weight: bold;
        }
        
        .paging-nav,
        #ibTransList {
            margin: 0 auto;
            font-family: Arial, sans-serif;
        }
    </style>

    <title>Agribank Internet Banking | Transaction Page</title>
    <script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous"
  ></script>
</head>

<body>

    <div class="header">
        <div class="wrapper">
            <div class="logo">
                <a title="Agribank" href="#"><img src="img/logo_agribank.png" /></a>
            </div>
            <!--end .logo-->
            <div class="pageStatus">

            </div>
            <!--end .page status-->
            <br class="clear">
        </div>
    </div>
    <!--end .header-->






    <div class="section color_brand">
        <div class="wrapper">
            <div class="mainContent">
                <div class="step_service">
                    <img class="img_stepSer" src="img/i-service_4sub.png" />
                    <h1>Chuyển khoản</h1>
                </div>
            </div>
            <!--end.mainContent-->
            <br class="clear">
        </div>
    </div>


    <div class="section height_x">
        <div class="wrapper">

        </div>
    </div>



    <!--end .section-->

    <div class="content">
        <div class="wrapper">

            <div class="aside">
                <ul id="browser" class="navAside">
                    <li class="closed"><a href="/signin">Trang chủ</a></li>
                    <li class="closed">
                        <a href="#"></a>
                        <ul>
                            <li><a href="/thongtin">Thông tin tài khoản</a></li>
                            <li><a href="/chuyenkhoan">Chuyển khoản</a>
                                <ul>
                                    <li class="act"><a href="/chuyentien">Lập Giao Dịch</a></li>
                                </ul>
                                <ul>
                                    <li class="last"><a href="/lichsu">Tra cứu trạng thái giao dịch</a></li>
                                </ul>


                        </ul>
                        </li>
                    </li>

                    <li class="closed"><a href="#">Liên hệ</a></li>
                </ul>
            </div>
            <!--end .aside-->

            <div class="mainContent template-signin">
                <div class="template-alert"></div>
                <p>&nbsp;</p>
                <p>&nbsp;</p>
                <p>&nbsp;</p>
                <p>&nbsp;</p>
                
                

             
             


            </div>
           
            <!--end .mainContent-->
            <br class="clear">

        </div>
    </div>
    <!--end .content-->

    <div class="footer">
        <div class="wrapper">
            <div class="r_footer">
                <table width="135" border="0" cellpadding="2" cellspacing="0" title="Click to Verify - This site chose Symantec SSL for secure e-commerce and confidential communications.">
                    <tr>
                        <td width="135" align="center" valign="top">
                            <script type="text/javascript" src="https://seal.websecurity.norton.com/getseal?host_name=ibank.agribank.com.vn&amp;size=S&amp;use_flash=YES&amp;use_transparent=YES&amp;lang=en"></script><br />
                            <a href="https://www.symantec.com/ssl-certificates" target="_blank" style="color: #000000; text-decoration: none; font: bold 7px verdana, sans-serif; letter-spacing: .5px; text-align: center; margin: 0px; padding: 0px;">ABOUT
								SSL CERTIFICATES</a></td>
                    </tr>
                </table>
            </div>
            <div class="contFooter">
                <p>&copy; 2009 - 2019 Bản quyền thuộc về</p>
                <p>Ngân hàng Nông nghiệp và Phát triển Nông thôn Việt Nam</p>
            </div>
            <br class="clear">
        </div>
    </div>
    <!--end .footer-->

</body>
<script>

   function getCookie(cname) {
      var name = cname + "=";
      var decodedCookie = decodeURIComponent(document.cookie);
      var ca = decodedCookie.split(";");
      for (var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == " ") {
          c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
          return c.substring(name.length, c.length);
        }
      }
      return "";
    }
    const token = getCookie("t");
    const data = JSON.parse(localStorage.getItem("IDUser"));
    if (token&&data.id) {
        const template=`
        <div class="form-transfer">
            
            <form>
                    <div class="form-group">
                      <label for="exampleInputEmail1">Nhập STK</label>
                      <input type="text" class="form-control inp-STK" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="Nhập STK">
                      <div class="check-user"></div>
                      <br/>
                      <button type="button" class="btn btn-small btn-success btn-kt">Kiểm tra</button>
                     
                    </div>
                    <div class="form-group">
                      <label for="exampleInputEmail1">Nhập số tiền</label>
                      <input type="text" class="form-control inp-money" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="Nhập số tiền">
                 
                     
                    </div>
                    <div class="form-group">
                      <label for="exampleInputEmail1">Nhập lời nhắn</label>
                      <textarea class="form-control" id="exampleFormControlTextarea1" rows="3" placeholder="Nhập lời nhắn"></textarea>
                     
                    </div>
                    <br/>
                    <button type="button" class="btn btn-danger btn-ct">Chuyển tiền</button>
                    <br/>
                    <br/>
                    <br/>
                    <br/>

                  </form>    
        </div>
        
        `
        $('.template-signin').append(template);
    } else {
        $('.template-signin').append(`
        <p align="center" class="textTitle">
        <font color="FF0000">Bạn cần đăng nhập trước khi sử dụng những chức năng này, xin cảm ơn..</font>
         </p>`
         );
    }
 
 
    $('.btn-kt').click(function(){
        const STK=$('.inp-STK').val();
         $.ajax({
             url:'/api/checkUser',
             type:'POST',
             data:{
                 STK:STK
             }
         }).then((data)=>{
             console.log(data)
             $('.check-user').append(`
             <label for="Name">Tên : ${data.name}</label>
             <br/>
             <label for="Email">Email : ${data.email}</label>
             `)

             localStorage.setItem('idUserReceive',JSON.stringify({
                 id:data.id
             }))
         })
    })
 
  

    $('.btn-ct').click(function(){
        $('.template-alert').html('')
        const idUserReceive=JSON.parse(localStorage.getItem('idUserReceive'))
        const numMoney=$('.inp-money').val();
         $.ajax({
             url:`/${data.id}/transfer/${idUserReceive.id}`,
             type:'PUT',
             data:{
                 numMoney:numMoney
             },
             headers:{
                 'Authorization':`Bearer ${token}`
             }
         }).then((data)=>{
             if (data.error) {
                $('.template-alert').append(`
                 <div class="alert alert-danger" role="alert">
                      Số dư không đủ
                 </div>
                 `)
                 setTimeout(function(){
                    window.location.href='/chuyenkhoan'
                },2500)
             }
             if (data.message) {
                 $('.template-alert').append(`
                 <div class="alert alert-success" role="alert">
                      Chuyển tiền thành công
                 </div>
                 `)
                 setTimeout(function(){
                    window.location.href='/thongtin'
                },2500)
             }
            
            
         })
    })

    
       
    
    
</script>

</html>